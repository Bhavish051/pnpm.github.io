"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7434],{9848:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var o=n(7689);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var p=o.createContext({}),s=function(e){var t=o.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=s(e.components);return o.createElement(p.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=s(n),m=r,h=d["".concat(p,".").concat(m)]||d[m]||u[m]||a;return n?o.createElement(h,i(i({ref:t},c),{},{components:n})):o.createElement(h,i({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=d;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var s=2;s<a;s++)i[s]=n[s];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},9191:(e,t,n)=>{n.r(t),n.d(t,{frontMatter:()=>l,contentTitle:()=>p,metadata:()=>s,toc:()=>c,default:()=>d});var o=n(2951),r=n(9877),a=(n(7689),n(9848)),i=["components"],l={title:"pnpm \u3067\u306e\u30ce\u30fc\u30c9\u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u95a2\u3059\u308b\u30aa\u30d7\u30b7\u30e7\u30f3\u8a2d\u5b9a",author:"Zoltan Kochan",authorURL:"http://twitter.com/zoltankochan",authorImageURL:"https://pbs.twimg.com/profile_images/1143606083262586880/EW2GCFKK_400x400.jpg"},p=void 0,s={permalink:"/ja/blog/2020/10/17/node-modules-configuration-options-with-pnpm",editUrl:"https://crowdin.com/project/pnpm/ja",source:"@site/i18n/ja/docusaurus-plugin-content-blog/2020-10-17-node-modules-configuration-options-with-pnpm.md",title:"pnpm \u3067\u306e\u30ce\u30fc\u30c9\u30e2\u30b8\u30e5\u30fc\u30eb\u306b\u95a2\u3059\u308b\u30aa\u30d7\u30b7\u30e7\u30f3\u8a2d\u5b9a",description:"nodemodules \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u751f\u6210\u3059\u308b\u65b9\u6cd5\u306f\u591a\u304f\u3042\u308a\u307e\u3059\u3002 \u3086\u308b\u3044 nodemodules \u3092\u4f5c\u6210\u3059\u308b\u65b9\u6cd5\u3082\u3042\u308a\u307e\u3059\u304c\u3001\u3053\u3053\u3067\u306e\u76ee\u6a19\u306f\u6700\u3082\u53b3\u683c\u306a\u3082\u306e\u3092\u751f\u6210\u3059\u308b\u3053\u3068\u3067\u3059\u3002",date:"2020-10-17T00:00:00.000Z",formattedDate:"2020\u5e7410\u670817\u65e5",tags:[],readingTime:1.41,truncated:!0,nextItem:{title:"\u30d5\u30e9\u30c3\u30c8\u306a node_modules \u304c\u552f\u4e00\u306e\u65b9\u6cd5\u3067\u306f\u3042\u308a\u307e\u305b\u3093",permalink:"/ja/blog/2020/05/27/flat-node-modules-is-not-the-only-way"}},c=[{value:"\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u69cb\u7bc9\u65b9\u6cd5",id:"\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u69cb\u7bc9\u65b9\u6cd5",children:[]},{value:"Plug&#39;n&#39;Play. The strictest configuration",id:"plugnplay-the-strictest-configuration",children:[]},{value:"A strict, traditional modules directory",id:"a-strict-traditional-modules-directory",children:[]},{value:"The worst case - hoisting to the root",id:"the-worst-case---hoisting-to-the-root",children:[]}],u={toc:c};function d(e){var t=e.components,n=(0,r.Z)(e,i);return(0,a.kt)("wrapper",(0,o.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"node_modules \u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u3092\u751f\u6210\u3059\u308b\u65b9\u6cd5\u306f\u591a\u304f\u3042\u308a\u307e\u3059\u3002 \u3086\u308b\u3044 node_modules \u3092\u4f5c\u6210\u3059\u308b\u65b9\u6cd5\u3082\u3042\u308a\u307e\u3059\u304c\u3001\u3053\u3053\u3067\u306e\u76ee\u6a19\u306f\u6700\u3082\u53b3\u683c\u306a\u3082\u306e\u3092\u751f\u6210\u3059\u308b\u3053\u3068\u3067\u3059\u3002"),(0,a.kt)("h2",{id:"\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u69cb\u7bc9\u65b9\u6cd5"},"\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u69cb\u7bc9\u65b9\u6cd5"),(0,a.kt)("p",null,"\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u306f\u3001pnpm v5 \u306f\u6e96\u53b3\u683c\u306a node_modules \u3092\u4f5c\u6210\u3057\u307e\u3059\u3002 \u6e96\u53b3\u683c\u306a\u5834\u5408\u306f\u3001\u30a2\u30d7\u30ea\u30b1\u30fc\u30b7\u30e7\u30f3\u304b\u3089\u306f",(0,a.kt)("inlineCode",{parentName:"p"},"package.json")," \u306b\u4f9d\u5b58\u3068\u3057\u3066\u8ffd\u52a0\u3055\u308c\u3066\u3044\u308b\u30d1\u30c3\u30b1\u30fc\u30b8\u306e\u307f\u3092 require \u3067\u304d\u307e\u3059\u3002(\u3044\u304f\u3064\u304b\u306e\u4f8b\u5916\u3092\u9664\u304d\u307e\u3059\u3002) \u305f\u3060\u3057\u3001\u4f9d\u5b58\u95a2\u4fc2\u306f\u3069\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u306b\u3082\u30a2\u30af\u30bb\u30b9\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),(0,a.kt)("p",null,"\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u8a2d\u5b9a\u306f\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u306a\u308a\u307e\u3059:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ini"},"; \u3059\u3079\u3066\u306e\u30d1\u30c3\u30b1\u30fc\u30b8\u3092 node_modules/.pnpm/node_modules \u306b\u5dfb\u304d\u4e0a\u3052\u308b\nhoist-pattern[]=*\n\n; TypeScript \u3067\u3046\u307e\u304f\u6271\u3048\u308b\u3088\u3046\u306b\u3001\u3059\u3079\u3066\u306e\u578b\u5b9a\u7fa9\u3092\u30eb\u30fc\u30c8\u306b\u5dfb\u304d\u4e0a\u3052\u308b\npublic-hoist-pattern[]=*types*\n\n; \u3059\u3079\u3066\u306e ESLint \u306b\u95a2\u4fc2\u3059\u308b\u30d1\u30c3\u30b1\u30fc\u30b8\u3092\u30eb\u30fc\u30c8\u306b\u5dfb\u304d\u4e0a\u3052\u308b\npublic-hoist-pattern[]=*eslint*\n")),(0,a.kt)("h2",{id:"plugnplay-the-strictest-configuration"},"Plug'n'Play. The strictest configuration"),(0,a.kt)("p",null,"pnpm supports ",(0,a.kt)("a",{parentName:"p",href:"https://yarnpkg.com/features/pnp"},"Yarn's Plug'n'Play")," since v5.9. With PnP, both your application and the dependencies of your application will have access only to their declared dependencies. This is even stricter then setting ",(0,a.kt)("inlineCode",{parentName:"p"},"hoist=false")," because inside a monorepo, you're application will not be able to access even the dependencies of the root project."),(0,a.kt)("p",null,"To use Plug'n'Play, set these settings:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ini"},"node-linker=pnp\nsymlink=false\n")),(0,a.kt)("h2",{id:"a-strict-traditional-modules-directory"},"A strict, traditional modules directory"),(0,a.kt)("p",null,"If you are not ready to use PnP yet, you can still be strict and only allow packages to access their own dependencies by setting the hoist configuration to false:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ini"},"hoist=false\n")),(0,a.kt)("p",null,"However, if some of your dependencies are trying to access packages that they don't have in dependencies, you have two options:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Create a ",(0,a.kt)("inlineCode",{parentName:"p"},"pnpmfile.js")," and use a ",(0,a.kt)("a",{parentName:"p",href:"/pnpmfile"},"hook")," to add the missing dependency to the package's manifest.")),(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"Add a pattern to the ",(0,a.kt)("inlineCode",{parentName:"p"},"hoist-pattern")," setting. For instance, if the not found module is ",(0,a.kt)("inlineCode",{parentName:"p"},"babel-core"),", add the following setting to ",(0,a.kt)("inlineCode",{parentName:"p"},".npmrc"),":"),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-ini"},"hoist-pattern[]=babel-core\n")))),(0,a.kt)("h2",{id:"the-worst-case---hoisting-to-the-root"},"The worst case - hoisting to the root"),(0,a.kt)("p",null,"Some tools might not work even with the default configuration of pnpm, which hoists everything to the root of the virtual store and some packages to the root. In this case, you can hoist either everything or a subset of dependencies to the root of the modules directory."),(0,a.kt)("p",null,"Hoisting everything to the the root of node_modules:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ini"},"shamefully-hoist=true\n")),(0,a.kt)("p",null,"Hoisting only packages that match a pattern:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ini"},"public-hoist-pattern[]=babel-*\n")))}d.isMDXComponent=!0}}]);