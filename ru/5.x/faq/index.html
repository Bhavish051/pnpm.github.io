<!doctype html>
<html lang="ru" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.72">
<link rel="alternate" type="application/rss+xml" href="/ru/blog/rss.xml" title="pnpm Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/ru/blog/atom.xml" title="pnpm Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-91385296-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-91385296-1",{anonymize_ip:!0})</script>
<link rel="search" type="application/opensearchdescription+xml" title="pnpm" href="/ru/opensearch.xml">
<script src="https://buttons.github.io/buttons.js"></script><title data-react-helmet="true">–ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã | pnpm</title><meta data-react-helmet="true" property="og:image" content="https://pnpm.io/ru/img/ogimage.png"><meta data-react-helmet="true" name="twitter:image" content="https://pnpm.io/ru/img/ogimage.png"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://pnpm.io/ru/5.x/faq"><meta data-react-helmet="true" name="docsearch:language" content="ru"><meta data-react-helmet="true" name="docsearch:version" content="5.x"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-5.x"><meta data-react-helmet="true" property="og:title" content="–ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã | pnpm"><meta data-react-helmet="true" name="description" content="Why does my node_modules folder use disk space if packages are stored in a global store?"><meta data-react-helmet="true" property="og:description" content="Why does my node_modules folder use disk space if packages are stored in a global store?"><link data-react-helmet="true" rel="shortcut icon" href="/ru/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://pnpm.io/ru/5.x/faq"><link data-react-helmet="true" rel="alternate" href="https://pnpm.io/5.x/faq" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://pnpm.io/zh/5.x/faq" hreflang="zh"><link data-react-helmet="true" rel="alternate" href="https://pnpm.io/es/5.x/faq" hreflang="es"><link data-react-helmet="true" rel="alternate" href="https://pnpm.io/pt/5.x/faq" hreflang="pt"><link data-react-helmet="true" rel="alternate" href="https://pnpm.io/ru/5.x/faq" hreflang="ru"><link data-react-helmet="true" rel="alternate" href="https://pnpm.io/it/5.x/faq" hreflang="it"><link data-react-helmet="true" rel="alternate" href="https://pnpm.io/tr/5.x/faq" hreflang="tr"><link data-react-helmet="true" rel="alternate" href="https://pnpm.io/hu/5.x/faq" hreflang="hu"><link data-react-helmet="true" rel="alternate" href="https://pnpm.io/5.x/faq" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/ru/assets/css/styles.d75f9059.css">
<link rel="preload" href="/ru/assets/js/styles.ad68d472.js" as="script">
<link rel="preload" href="/ru/assets/js/runtime~main.eeebc81b.js" as="script">
<link rel="preload" href="/ru/assets/js/main.5061d2b1.js" as="script">
<link rel="preload" href="/ru/assets/js/1.df7d03a2.js" as="script">
<link rel="preload" href="/ru/assets/js/2.af1fe768.js" as="script">
<link rel="preload" href="/ru/assets/js/3.61fe98b0.js" as="script">
<link rel="preload" href="/ru/assets/js/1be78505.2accc930.js" as="script">
<link rel="preload" href="/ru/assets/js/245.2bd68bd2.js" as="script">
<link rel="preload" href="/ru/assets/js/561a3eb1.b133d5de.js" as="script">
<link rel="preload" href="/ru/assets/js/17896441.1b932f2f.js" as="script">
<link rel="preload" href="/ru/assets/js/0a64bdd8.bf10b529.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_30HU">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ru/"><img src="/ru/img/pnpm-no-name-with-frame.svg" alt="pnpm" class="themedImage_1qN6 themedImage--light_d0Ch navbar__logo"><img src="/ru/img/pnpm-no-name-with-frame.svg" alt="pnpm" class="themedImage_1qN6 themedImage--dark_3Bnv navbar__logo"><strong class="navbar__title">pnpm</strong></a><a class="navbar__item navbar__link" href="/ru/motivation">–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</a><a class="navbar__item navbar__link" href="/ru/blog">Blog</a><a class="navbar__item navbar__link" href="/ru/faq">FAQ</a><a class="navbar__item navbar__link" href="/ru/benchmarks">Benchmarks</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link" href="/ru/5.x/motivation">5.x</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/ru/next/faq">Next</a></li><li><a class="dropdown__link" href="/ru/faq">6.x</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/ru/5.x/faq">5.x</a></li><li><a class="dropdown__link" href="/ru/4.x/faq">4.x</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__item navbar__link"><span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" style="vertical-align:text-bottom;margin-right:5px"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>–†—É—Å—Å–∫–∏–π</span></span></a><ul class="dropdown__menu"><li><a href="/5.x/faq" target="_self" rel="noopener noreferrer" class="dropdown__link">English</a></li><li><a href="/zh/5.x/faq" target="_self" rel="noopener noreferrer" class="dropdown__link">‰∏≠Êñá</a></li><li><a href="/es/5.x/faq" target="_self" rel="noopener noreferrer" class="dropdown__link">Espa√±ol</a></li><li><a href="/pt/5.x/faq" target="_self" rel="noopener noreferrer" class="dropdown__link">Portugu√™s Brasileiro</a></li><li><a href="/ru/5.x/faq" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">–†—É—Å—Å–∫–∏–π</a></li><li><a href="/it/5.x/faq" target="_self" rel="noopener noreferrer" class="dropdown__link">Italiano</a></li><li><a href="/tr/5.x/faq" target="_self" rel="noopener noreferrer" class="dropdown__link">T√ºrk√ße</a></li><li><a href="/hu/5.x/faq" target="_self" rel="noopener noreferrer" class="dropdown__link">Magyar</a></li><li><a href="https://crowdin.com/project/pnpm" target="_blank" rel="noopener noreferrer" class="dropdown__link">Help Us Translate</a></li></ul></div><a href="https://opencollective.com/pnpm" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Sponsor Us</a><a href="https://github.com/pnpm/pnpm" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_4Ywa"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_19WN">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_19WN">üåû</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="–ü–æ–∏—Å–∫"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">–ü–æ–∏—Å–∫</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/ru/"><img src="/ru/img/pnpm-no-name-with-frame.svg" alt="pnpm" class="themedImage_1qN6 themedImage--light_d0Ch navbar__logo"><img src="/ru/img/pnpm-no-name-with-frame.svg" alt="pnpm" class="themedImage_1qN6 themedImage--dark_3Bnv navbar__logo"><strong class="navbar__title">pnpm</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/ru/motivation">–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</a></li><li class="menu__list-item"><a class="menu__link" href="/ru/blog">Blog</a></li><li class="menu__list-item"><a class="menu__link" href="/ru/faq">FAQ</a></li><li class="menu__list-item"><a class="menu__link" href="/ru/benchmarks">Benchmarks</a></li><li class="menu__list-item"><a role="button" class="menu__link menu__link--sublist">Versions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/ru/next/faq">Next</a></li><li class="menu__list-item"><a class="menu__link" href="/ru/faq">6.x</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" href="/ru/5.x/faq">5.x</a></li><li class="menu__list-item"><a class="menu__link" href="/ru/4.x/faq">4.x</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a href="#" role="button" class="menu__link menu__link--sublist"><span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20" style="vertical-align:text-bottom;margin-right:5px"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>Languages</span></span></a><ul class="menu__list"><li class="menu__list-item"><a href="/5.x/faq" target="_self" rel="noopener noreferrer" class="menu__link">English</a></li><li class="menu__list-item"><a href="/zh/5.x/faq" target="_self" rel="noopener noreferrer" class="menu__link">‰∏≠Êñá</a></li><li class="menu__list-item"><a href="/es/5.x/faq" target="_self" rel="noopener noreferrer" class="menu__link">Espa√±ol</a></li><li class="menu__list-item"><a href="/pt/5.x/faq" target="_self" rel="noopener noreferrer" class="menu__link">Portugu√™s Brasileiro</a></li><li class="menu__list-item"><a href="/ru/5.x/faq" target="_self" rel="noopener noreferrer" class="menu__link dropdown__link--active">–†—É—Å—Å–∫–∏–π</a></li><li class="menu__list-item"><a href="/it/5.x/faq" target="_self" rel="noopener noreferrer" class="menu__link">Italiano</a></li><li class="menu__list-item"><a href="/tr/5.x/faq" target="_self" rel="noopener noreferrer" class="menu__link">T√ºrk√ße</a></li><li class="menu__list-item"><a href="/hu/5.x/faq" target="_self" rel="noopener noreferrer" class="menu__link">Magyar</a></li><li class="menu__list-item"><a href="https://crowdin.com/project/pnpm" target="_blank" rel="noopener noreferrer" class="menu__link">Help Us Translate</a></li></ul></li><li class="menu__list-item"><a href="https://opencollective.com/pnpm" target="_blank" rel="noopener noreferrer" class="menu__link">Sponsor Us</a></li><li class="menu__list-item"><a href="https://github.com/pnpm/pnpm" target="_blank" rel="noopener noreferrer" class="menu__link header-github-link" aria-label="GitHub repository"></a></li></ul></div></div></div></nav><div class="main-wrapper main-docs-wrapper"><div class="docPage_20fr"><main class="docMainContainer_1Dy0"><div class="container padding-vert--lg docItemWrapper_3Wpq"><div class="row"><div class="col docItemCol_2VMt"><div class="alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for pnpm <strong>5.x</strong>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <strong><a href="/ru/faq">latest version</a></strong> (6.x).</div></div><div class="docItemContainer_24YU"><article><div><span class="badge badge--secondary">Version: 5.x</span></div><header><h1 class="docTitle_2-rS">–ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k4_3" id="why-does-my-node_modules-folder-use-disk-space-if-packages-are-stored-in-a-global-store"></a>Why does my <code>node_modules</code> folder use disk space if packages are stored in a global store?<a class="hash-link" href="#why-does-my-node_modules-folder-use-disk-space-if-packages-are-stored-in-a-global-store" title="Direct link to heading">#</a></h2><p>pnpm creates <a href="https://en.wikipedia.org/wiki/Hard_link" target="_blank" rel="noopener noreferrer">hard links</a> from the global store to the project&#x27;s <code>node_modules</code> folders. Hard links point to the same place on the disk where the original files are. So, for example, if you have <code>foo</code> in your project as a dependency and it occupies 1MB of space, then it will look like it occupies 1MB of space in the project&#x27;s <code>node_modules</code> folder and the same amount of space in the global store. However, that 1MB is <em>the same space</em> on the disk addressed from two different locations. So in total <code>foo</code> occupies 1MB, not 2MB.</p><p>For more on this subject:</p><ul><li><a href="https://unix.stackexchange.com/questions/88423/why-do-hard-links-seem-to-take-the-same-space-as-the-originals" target="_blank" rel="noopener noreferrer">Why do hard links seem to take the same space as the originals?</a></li><li><a href="https://gist.github.com/zkochan/106cfef49f8476b753a9cbbf9c65aff1" target="_blank" rel="noopener noreferrer">A thread from the pnpm chat room</a></li><li><a href="https://github.com/pnpm/pnpm/issues/794" target="_blank" rel="noopener noreferrer">An issue in the pnpm repo</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k4_3" id="—Ä–∞–±–æ—Ç–∞–µ—Ç-–ª–∏-–≤-windows"></a>–†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –≤ Windows?<a class="hash-link" href="#—Ä–∞–±–æ—Ç–∞–µ—Ç-–ª–∏-–≤-windows" title="Direct link to heading">#</a></h2><p>–ö—Ä–∞—Ç–∫–∏–π –æ—Ç–≤–µ—Ç: –î–∞. –î–ª–∏–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–∏—Ö —Å—Å—ã–ª–æ–∫ –≤ Windows –ø—Ä–æ–±–ª–µ–º–∞—Ç–∏—á–Ω–æ, –æ–¥–Ω–∞–∫–æ —É pnpm –µ—Å—Ç—å –æ–±—Ö–æ–¥–Ω–æ–π –ø—É—Ç—å. For Windows, we use <a href="https://docs.microsoft.com/en-us/windows/win32/fileio/hard-links-and-junctions" target="_blank" rel="noopener noreferrer">junctions</a> instead.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k4_3" id="–Ω–æ-–≤–ª–æ–∂–µ–Ω–Ω—ã–µ-node_modules-–Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã-—Å-windows"></a>–ù–æ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ <code>node_modules</code> –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å Windows?<a class="hash-link" href="#–Ω–æ-–≤–ª–æ–∂–µ–Ω–Ω—ã–µ-node_modules-–Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã-—Å-windows" title="Direct link to heading">#</a></h2><p>Early versions of npm had issues because of nesting all <code>node_modules</code> (see <a href="https://github.com/nodejs/node-v0.x-archive/issues/6960" target="_blank" rel="noopener noreferrer">this issue</a>. However, pnpm does not create deep folders, it stores all packages flatly and uses symbolic links to create the dependency tree structure.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k4_3" id="–∞-–∫–∞–∫-–Ω–∞—Å—á–µ—Ç-–∫—Ä—É–≥–æ–≤—ã—Ö-—Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–∏—Ö-—Å—Å—ã–ª–æ–∫"></a>–ê –∫–∞–∫ –Ω–∞—Å—á–µ—Ç –∫—Ä—É–≥–æ–≤—ã—Ö —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–∏—Ö —Å—Å—ã–ª–æ–∫?<a class="hash-link" href="#–∞-–∫–∞–∫-–Ω–∞—Å—á–µ—Ç-–∫—Ä—É–≥–æ–≤—ã—Ö-—Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–∏—Ö-—Å—Å—ã–ª–æ–∫" title="Direct link to heading">#</a></h2><p>Although pnpm uses linking to put dependencies into <code>node_modules</code> folders, circular symlinks are avoided because parent packages are placed into the same <code>node_modules</code> folder in which their dependencies are. So <code>foo</code>&#x27;s dependencies are not in <code>foo/node_modules</code>, but <code>foo</code> is in <code>node_modules</code> together with its own dependencies.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k4_3" id="why-have-hard-links-at-all-why-not-symlink-directly-to-the-global-store"></a>Why have hard links at all? Why not symlink directly to the global store?<a class="hash-link" href="#why-have-hard-links-at-all-why-not-symlink-directly-to-the-global-store" title="Direct link to heading">#</a></h2><p>One package can have different sets of dependencies on one machine.</p><p>In project <strong>A</strong> <code>foo@1.0.0</code> can have a dependency resolved to <code>bar@1.0.0</code>, but in project <strong>B</strong> the same dependency of <code>foo</code> might resolve to <code>bar@1.1.0</code>; so, pnpm hard links <code>foo@1.0.0</code> to every project where it is used, in order to create different sets of dependencies for it.</p><p>Direct symlinking to the global store would work with Node&#x27;s <code>--preserve-symlinks</code> flag, however, that approach comes with a plethora of its own issues, so we decided to stick with hard links. For more details about why this decision was made, see <a href="https://github.com/nodejs/node-eps/issues/46" target="_blank" rel="noopener noreferrer">this issue</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k4_3" id="does-pnpm-work-across-multiple-drives-or-filesystems"></a>Does pnpm work across multiple drives or filesystems?<a class="hash-link" href="#does-pnpm-work-across-multiple-drives-or-filesystems" title="Direct link to heading">#</a></h2><p>The package store should be on the same drive and filesystem as installations, otherwise packages will be copied, not linked. This is due to a limitation in how hard linking works, in that a file on one filesystem cannot address a location in another. See <a href="https://github.com/pnpm/pnpm/issues/712" target="_blank" rel="noopener noreferrer">Issue #712</a> for more details.</p><p>pnpm functions differently in the 2 cases below:</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k4_3" id="—É–∫–∞–∑–∞–Ω-–ø—É—Ç—å-–∫-—Ö—Ä–∞–Ω–∏–ª–∏—â—É"></a>–£–∫–∞–∑–∞–Ω –ø—É—Ç—å –∫ —Ö—Ä–∞–Ω–∏–ª–∏—â—É<a class="hash-link" href="#—É–∫–∞–∑–∞–Ω-–ø—É—Ç—å-–∫-—Ö—Ä–∞–Ω–∏–ª–∏—â—É" title="Direct link to heading">#</a></h3><p>If the store path is specified via <a href="/ru/5.x/configuring">the store config</a>, then copying occurs between the store and any projects that are on a different disk.</p><p>If you run <code>pnpm install</code> on disk <code>A</code>, then the pnpm store must be on disk <code>A</code>. If the pnpm store is located on disk <code>B</code>, then all required packages will be directly copied to the project location instead of being linked. This severely inhibits the storage and performance benefits of pnpm.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k4_3" id="store-path-is-not-specified"></a>Store path is NOT specified<a class="hash-link" href="#store-path-is-not-specified" title="Direct link to heading">#</a></h3><p>If the store path is not set, then multiple stores are created (one per drive or filesystem).</p><p>If installation is run on disk <code>A</code>, the store will be created on <code>A</code> <code>.pnpm-store</code> under the filesystem root.  If later the installation is run on disk <code>B</code>, an independent store will be created on <code>B</code> at <code>.pnpm-store</code>. The projects would still maintain the benefits of pnpm, but each drive may have redundant packages.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k4_3" id="—á—Ç–æ-–¥–µ–ª–∞–µ—Ç-pnpm-store-prune-—ç—Ç–æ-–æ–ø–∞—Å–Ω–æ"></a>–ß—Ç–æ –¥–µ–ª–∞–µ—Ç <code>pnpm store prune</code>? –≠—Ç–æ –æ–ø–∞—Å–Ω–æ?<a class="hash-link" href="#—á—Ç–æ-–¥–µ–ª–∞–µ—Ç-pnpm-store-prune-—ç—Ç–æ-–æ–ø–∞—Å–Ω–æ" title="Direct link to heading">#</a></h2><p>The command <code>pnpm store prune</code> removes <em>unreferenced packages</em>.</p><p>Unreferenced packages are packages that are not used by any projects on the system. Packages can become unreferenced after most installation operations, for instance when dependencies are made redundant.</p><p>For example, during <code>pnpm install</code>, package <code>foo@1.0.0</code> is updated to <code>foo@1.0.1</code>. pnpm will keep <code>foo@1.0.0</code> in the store, as it does not automatically remove packages. If package <code>foo@1.0.0</code> is not used by any other project on the system, it becomes unreferenced. Running <code>pnpm store prune</code> would remove <code>foo@1.0.0</code> from the store.</p><p>Running <code>pnpm store prune</code> is not harmful and has no side effects on your projects. If future installations require removed packages, pnpm will download them again.</p><p>It is best practice to run <code>pnpm store prune</code> occasionally to clean up the store, but not too frequently. Sometimes, unreferenced packages become required again. This could occur when switching branches and installing older dependencies, in which case pnpm would need to re-download all removed packages, briefly slowing down the installation process.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k4_3" id="what-does-pnpm-stand-for"></a>What does <code>pnpm</code> stand for?<a class="hash-link" href="#what-does-pnpm-stand-for" title="Direct link to heading">#</a></h2><p><code>pnpm</code> stands for <code>performant npm</code>. <a href="https://github.com/rstacruz/" target="_blank" rel="noopener noreferrer">Rico Sta. Cruz</a> came up with the name.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k4_3" id="pnpm-does-not-work-with-your-project-here"></a><code>pnpm</code> does not work with &lt;YOUR-PROJECT-HERE&gt;?<a class="hash-link" href="#pnpm-does-not-work-with-your-project-here" title="Direct link to heading">#</a></h2><p>In most cases it means that one of the dependencies require packages not declared in <code>package.json</code>. It is a common mistake caused by flat <code>node_modules</code>. If this happens, this is an error in the dependency and the dependency should be fixed. That might take time though, so pnpm supports workarounds to make the buggy packages work.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k4_3" id="—Ä–µ—à–µ–Ω–∏–µ-1"></a>–†–µ—à–µ–Ω–∏–µ 1<a class="hash-link" href="#—Ä–µ—à–µ–Ω–∏–µ-1" title="Direct link to heading">#</a></h3><p>In the following example, a dependency does <strong>not</strong> have the <code>iterall</code> module in its own list of deps.</p><p>The easiest solution to resolve missing dependencies of the buggy packages is to <strong>add <code>iterall</code> as a dependency to our project&#x27;s <code>package.json</code></strong>.</p><p>You can do so, by installing it via <code>pnpm add iterall</code>, and will be automatically added to your project&#x27;s <code>package.json</code>.</p><div class="codeBlockContainer_36cI"><div class="codeBlockContent_2dGA json"><div tabindex="0" class="prism-code language-json codeBlock_3DRt thin-scrollbar"><div class="codeBlockLines_2tyP" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;dependencies&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    ...</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token property" style="color:rgb(3, 47, 98)">&quot;iterall&quot;</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(3, 47, 98)">&quot;^1.2.2&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">,</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    ...</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_3DOv">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k4_3" id="—Ä–µ—à–µ–Ω–∏–µ-2"></a>–†–µ—à–µ–Ω–∏–µ 2<a class="hash-link" href="#—Ä–µ—à–µ–Ω–∏–µ-2" title="Direct link to heading">#</a></h3><p>One of the solutions is to use <a href="/ru/5.x/pnpmfile#hooks">hooks</a> for adding the missing dependencies to the package&#x27;s <code>package.json</code>.</p><p>An example was <a href="https://github.com/pnpm/pnpm/issues/1043" target="_blank" rel="noopener noreferrer">Webpack Dashboard</a> which wasn&#x27;t working with <code>pnpm</code>. It has since been resolved such that it works with <code>pnpm</code> now.</p><p>It used to throw an error:</p><div class="codeBlockContainer_36cI"><div class="codeBlockContent_2dGA console"><div tabindex="0" class="prism-code language-console codeBlock_3DRt thin-scrollbar"><div class="codeBlockLines_2tyP" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">Error: Cannot find module &#x27;babel-traverse&#x27;</span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  at /node_modules/inspectpack@2.2.3/node_modules/inspectpack/lib/actions/parse</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_3DOv">Copy</button></div></div><p>The problem was that <code>babel-traverse</code> was used in <code>inspectpack</code> which was used by <code>webpack-dashboard</code>, but <code>babel-traverse</code> wasn&#x27;t specified in <code>inspectpack</code>&#x27;s <code>package.json</code>. It still worked with <code>npm</code> and <code>yarn</code> because they create flat <code>node_modules</code>.</p><p>The solution was to create a <code>pnpmfile.js</code> with the following contents:</p><div class="codeBlockContainer_36cI"><div class="codeBlockContent_2dGA js"><div tabindex="0" class="prism-code language-js codeBlock_3DRt thin-scrollbar"><div class="codeBlockLines_2tyP" style="color:rgb(36, 41, 46);background-color:#f6f8fa"><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">module</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">exports</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  hooks</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token function-variable function" style="color:rgb(111, 66, 193)">readPackage</span><span class="token operator" style="color:rgb(0, 92, 197)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token parameter">pkg</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(0, 92, 197)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#e3116c">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">(</span><span class="token plain">pkg</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">name</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">===</span><span class="token plain"> </span><span class="token string">&quot;inspectpack&quot;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(36, 41, 46)">{</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">        pkg</span><span class="token punctuation" style="color:rgb(36, 41, 46)">.</span><span class="token property-access" style="color:rgb(111, 66, 193)">dependencies</span><span class="token punctuation" style="color:rgb(36, 41, 46)">[</span><span class="token string">&#x27;babel-traverse&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(0, 92, 197)">=</span><span class="token plain"> </span><span class="token string">&#x27;^6.26.0&#x27;</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">      </span><span class="token keyword control-flow" style="color:#e3116c">return</span><span class="token plain"> pkg</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token plain"></span></div><div class="token-line" style="color:rgb(36, 41, 46)"><span class="token plain"></span><span class="token punctuation" style="color:rgb(36, 41, 46)">}</span><span class="token punctuation" style="color:rgb(36, 41, 46)">;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_3DOv">Copy</button></div></div><p>After creating a <code>pnpmfile.js</code>, delete <code>pnpm-lock.yaml</code> only - there is no need to delete <code>node_modules</code>, as pnpm hooks only effect module resolution. Then, rebuild the dependencies &amp; it should be working.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_k4_3" id="—Ä–µ—à–µ–Ω–∏–µ-3"></a>–†–µ—à–µ–Ω–∏–µ 3<a class="hash-link" href="#—Ä–µ—à–µ–Ω–∏–µ-3" title="Direct link to heading">#</a></h3><p>In case there are too many issues, you can use the <code>shamefully-hoist</code> option. This creates a flat <code>node_modules</code> structure similar to the one created by <code>npm</code> or <code>yarn</code>, which is not recommended as avoiding this structure is the primary purpose of pnpm&#x27;s <code>node_modules</code> approach.</p><p>–ß—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ <code>pnpm install --shamefully-hoist</code>.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://crowdin.com/project/pnpm/ru" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2BxU" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_LVmN thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#why-does-my-node_modules-folder-use-disk-space-if-packages-are-stored-in-a-global-store" class="table-of-contents__link">Why does my <code>node_modules</code> folder use disk space if packages are stored in a global store?</a></li><li><a href="#—Ä–∞–±–æ—Ç–∞–µ—Ç-–ª–∏-–≤-windows" class="table-of-contents__link">–†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –≤ Windows?</a></li><li><a href="#–Ω–æ-–≤–ª–æ–∂–µ–Ω–Ω—ã–µ-node_modules-–Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã-—Å-windows" class="table-of-contents__link">–ù–æ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ <code>node_modules</code> –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å Windows?</a></li><li><a href="#–∞-–∫–∞–∫-–Ω–∞—Å—á–µ—Ç-–∫—Ä—É–≥–æ–≤—ã—Ö-—Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–∏—Ö-—Å—Å—ã–ª–æ–∫" class="table-of-contents__link">–ê –∫–∞–∫ –Ω–∞—Å—á–µ—Ç –∫—Ä—É–≥–æ–≤—ã—Ö —Å–∏–º–≤–æ–ª–∏—á–µ—Å–∫–∏—Ö —Å—Å—ã–ª–æ–∫?</a></li><li><a href="#why-have-hard-links-at-all-why-not-symlink-directly-to-the-global-store" class="table-of-contents__link">Why have hard links at all? Why not symlink directly to the global store?</a></li><li><a href="#does-pnpm-work-across-multiple-drives-or-filesystems" class="table-of-contents__link">Does pnpm work across multiple drives or filesystems?</a><ul><li><a href="#—É–∫–∞–∑–∞–Ω-–ø—É—Ç—å-–∫-—Ö—Ä–∞–Ω–∏–ª–∏—â—É" class="table-of-contents__link">–£–∫–∞–∑–∞–Ω –ø—É—Ç—å –∫ —Ö—Ä–∞–Ω–∏–ª–∏—â—É</a></li><li><a href="#store-path-is-not-specified" class="table-of-contents__link">Store path is NOT specified</a></li></ul></li><li><a href="#—á—Ç–æ-–¥–µ–ª–∞–µ—Ç-pnpm-store-prune-—ç—Ç–æ-–æ–ø–∞—Å–Ω–æ" class="table-of-contents__link">–ß—Ç–æ –¥–µ–ª–∞–µ—Ç <code>pnpm store prune</code>? –≠—Ç–æ –æ–ø–∞—Å–Ω–æ?</a></li><li><a href="#what-does-pnpm-stand-for" class="table-of-contents__link">What does <code>pnpm</code> stand for?</a></li><li><a href="#pnpm-does-not-work-with-your-project-here" class="table-of-contents__link"><code>pnpm</code> does not work with &lt;YOUR-PROJECT-HERE&gt;?</a><ul><li><a href="#—Ä–µ—à–µ–Ω–∏–µ-1" class="table-of-contents__link">–†–µ—à–µ–Ω–∏–µ 1</a></li><li><a href="#—Ä–µ—à–µ–Ω–∏–µ-2" class="table-of-contents__link">–†–µ—à–µ–Ω–∏–µ 2</a></li><li><a href="#—Ä–µ—à–µ–Ω–∏–µ-3" class="table-of-contents__link">–†–µ—à–µ–Ω–∏–µ 3</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/ru/installation">–ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã</a></li><li class="footer__item"><a class="footer__link-item" href="/ru/pnpm-cli">pnpm CLI</a></li><li class="footer__item"><a class="footer__link-item" href="/ru/workspaces">Workspace</a></li><li class="footer__item"><a class="footer__link-item" href="/ru/npmrc">.npmrc</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">–°–æ–æ–±—â–µ—Å—Ç–≤–æ</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/ru/users">User Showcase</a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/pnpm" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://r.pnpm.io/chat" target="_blank" rel="noopener noreferrer" class="footer__link-item">Project Chat</a></li><li class="footer__item"><a href="https://twitter.com/pnpmjs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Contributing</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/pnpm/pnpm" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://opencollective.com/pnpm" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sponsor Us</a></li><li class="footer__item"><a href="https://crowdin.com/project/pnpm" target="_blank" rel="noopener noreferrer" class="footer__link-item">–ü–æ–º–æ–≥–∏—Ç–µ –Ω–∞–º —Å –ø–µ—Ä–µ–≤–æ–¥–æ–º</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/ru/img/pnpm-light.svg" alt="" class="themedImage_1qN6 themedImage--light_d0Ch footer__logo"><img src="/ru/img/pnpm-light.svg" alt="" class="themedImage_1qN6 themedImage--dark_3Bnv footer__logo"></div><div class="footer__copyright">Copyright ¬© 2015-2021 contributors of pnpm</div></div></div></footer></div>
<script src="/ru/assets/js/styles.ad68d472.js"></script>
<script src="/ru/assets/js/runtime~main.eeebc81b.js"></script>
<script src="/ru/assets/js/main.5061d2b1.js"></script>
<script src="/ru/assets/js/1.df7d03a2.js"></script>
<script src="/ru/assets/js/2.af1fe768.js"></script>
<script src="/ru/assets/js/3.61fe98b0.js"></script>
<script src="/ru/assets/js/1be78505.2accc930.js"></script>
<script src="/ru/assets/js/245.2bd68bd2.js"></script>
<script src="/ru/assets/js/561a3eb1.b133d5de.js"></script>
<script src="/ru/assets/js/17896441.1b932f2f.js"></script>
<script src="/ru/assets/js/0a64bdd8.bf10b529.js"></script>
</body>
</html>